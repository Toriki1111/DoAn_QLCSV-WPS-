<UserControl x:Class="DoAn_QLCSV.UpCommingEvents"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="750" d:DesignWidth="1100"
             Background="Transparent">
    <UserControl.Resources>
        <Style TargetType="Button" x:Key="ActionButton">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </UserControl.Resources>

    <Grid Margin="18">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="12"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
            <TextBlock Text="SỰ KIỆN SẮP TỚI" FontSize="28" FontWeight="Bold" Foreground="White"/>
            <TextBlock x:Name="txtEventCount" Margin="16,0,0,0" Foreground="#FFD166" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Search + actions -->
        <Border Grid.Row="2" Background="#262626" CornerRadius="8" Padding="10" BorderBrush="#3E3E3E" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <DockPanel VerticalAlignment="Center">
                    <TextBox x:Name="txtSearch"
                             Width="420"
                             Height="34"
                             Margin="0"
                             VerticalContentAlignment="Center"
                             Background="#2F2F2F"
                             Foreground="White"
                             BorderBrush="#4A4A4A"
                             Padding="8"
                             TextChanged="txtSearch_TextChanged"/>
                </DockPanel>

                <Button Grid.Column="1" Content="🔄 Làm mới" Style="{StaticResource ActionButton}" Background="#1976D2" Click="btnRefresh_Click"/>
                <Button Grid.Column="2" Content="➕ Đăng sự kiện" Style="{StaticResource ActionButton}" Background="#2E7D32" Click="btnAddEvent_Click" Margin="8,0,0,0"/>
            </Grid>
        </Border>

        <!-- Events DataGrid -->
        <Border Grid.Row="4" Background="#262626" CornerRadius="10" Padding="12" BorderBrush="#3E3E3E" BorderThickness="1">
            <Grid>
                <DataGrid x:Name="dgEvents"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          IsReadOnly="True"
                          RowHeight="56"
                          HeadersVisibility="Column"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          AlternationCount="2">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Sự kiện" Binding="{Binding Name}" Width="2*"/>
                        <DataGridTextColumn Header="Ngày giờ" Binding="{Binding StartDateFormatted}" Width="160"/>
                        <DataGridTextColumn Header="Địa điểm" Binding="{Binding Location}" Width="1.5*"/>
                        <DataGridTextColumn Header="Đã đăng ký" Binding="{Binding RegisteredCount}" Width="90"/>
                        <DataGridTemplateColumn Header="Hành động" Width="180">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="👁 Xem" Style="{StaticResource ActionButton}" Background="#1976D2"
                                                Click="btnViewEvent_Click" Tag="{Binding}"/>
                                        <Button Content="✓ Đăng ký" Style="{StaticResource ActionButton}" Background="#2E7D32"
                                                Click="btnRegisterEvent_Click" Tag="{Binding}" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel x:Name="EmptyState" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="📅" FontSize="56" Foreground="#666" HorizontalAlignment="Center"/>
                    <TextBlock Text="Không có sự kiện sắp tới" FontSize="16" Foreground="#999" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>